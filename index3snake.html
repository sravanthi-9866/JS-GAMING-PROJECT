<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Snake</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #222;
      background-image: url("https://media.istockphoto.com/id/1346095076/video/loading-bar-snake-eats-apple-looped-2d-animation.mp4"); 
      background-size: cover;
      background-position: center;
    }

    .wrapper {
      width: 400px;
      height: 500px;
      background-color: #333;
      display: flex;
      flex-direction: column;
      align-items: center;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      position: relative;
    }

    .game-details {
      width: 100%;
      display: flex;
      justify-content: space-between;
      padding: 15px;
      color: #fff;
      font-size: 18px;
    }

    .play-board {
      width: 90%;
      height: 350px;
      background-color: #000;
      position: relative;
      display: grid;
      grid-template: repeat(30, 1fr) / repeat(30, 1fr);
      border-radius: 5px;
      overflow: hidden;
    }

    .snake {
      width: 20px;
      height: 20px;
      background-color: lime;
      position: absolute;
      border-radius: 3px;
    }

    .food {
      width: 14px;
      height: 14px;
      background-color: red;
      position: absolute;
    }

    img.game-over-image {
      width: 300px;
      height: 300px;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    .reload-btn {
      position: absolute;
      top: 95%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 5px;
      color: red;
      background-color: white;
      border: none;
      cursor: pointer;
      border-radius: 5px;
    }

    .controls {
      display: flex;
      justify-content: space-around;
      gap: 10px;
      margin-top: 10px;
    }

    .controls i {
      font-size: 24px;
      padding: 10px;
      background-color: #ddd;
      border-radius: 5px;
      cursor: pointer;
    }

    .pause-btn {
      margin-top: 10px;
      padding: 8px 20px;
      background-color: #666;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .go-back-btn {
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 1000;
    }

    .go-back-btn button {
      padding: 8px 12px;
      font-size: 16px;
      border-radius: 5px;
      cursor: pointer;
      background-color: white;
      color: red;
      border: none;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
      transition: background-color 0.3s ease;
    }

    .go-back-btn button:hover {
      background-color: #f8d7da;
    }
  </style>
</head>
<body>

  <div class="wrapper">
    <div class="game-details">
      <span class="score">Score: 0</span>
      <span class="high-score">High Score: 0</span>
    </div>
    <div class="play-board"></div>
    <div class="controls">
      <i data-key="ArrowUp" class="fa-solid fa-arrow-up"></i>
      <i data-key="ArrowRight" class="fa-solid fa-arrow-right"></i>
      <i data-key="ArrowDown" class="fa-solid fa-arrow-down"></i>
      <i data-key="ArrowLeft" class="fa-solid fa-arrow-left"></i>
    </div>
    <button class="pause-btn" onclick="togglePause()">Pause</button>
  </div>

  <div class="go-back-btn">
    <a href="./index.html"><button>Go Back</button></a>
  </div>

  <script>
    const playBoard = document.querySelector(".play-board");
    const scoreEle = document.querySelector(".score");
    const highScoreEle = document.querySelector(".high-score");
    const controls = document.querySelectorAll(".controls i");

    let gameOver = false;
    let score = 0;
    let foodX, foodY;
    let velocityX = 0, velocityY = 0;
    let snakeBody = [];
    let snakeX = 7, snakeY = 10;
    let setIntervalId;
    let isPaused = false;

    let highScore = localStorage.getItem("high-score") || 0;
    highScoreEle.textContent = `High Score: ${highScore}`;

    const changeFoodPosition = () => {
      foodX = Math.floor(Math.random() * 30) + 1;
      foodY = Math.floor(Math.random() * 30) + 1;
    };

    const handleGameOver = () => {
      clearInterval(setIntervalId);
      playBoard.innerHTML += `
        <img src="./images/lost.gif" class="game-over-image" />
        <button class="reload-btn" onclick="location.reload()">Play Again</button>
      `;
    };

    const changeDirection = (e) => {
      if (e.key === "ArrowUp" && velocityY === 0) {
        velocityX = 0; velocityY = -1;
      } else if (e.key === "ArrowDown" && velocityY === 0) {
        velocityX = 0; velocityY = 1;
      } else if (e.key === "ArrowLeft" && velocityX === 0) {
        velocityX = -1; velocityY = 0;
      } else if (e.key === "ArrowRight" && velocityX === 0) {
        velocityX = 1; velocityY = 0;
      }
    };

    controls.forEach(key => {
      key.addEventListener("click", () => changeDirection({ key: key.dataset.key }));
    });

    const togglePause = () => {
      const btn = document.querySelector(".pause-btn");
      if (isPaused) {
        setIntervalId = setInterval(initGame, 120);
        btn.textContent = "Pause";
      } else {
        clearInterval(setIntervalId);
        btn.textContent = "Resume";
      }
      isPaused = !isPaused;
    };

    const initGame = () => {
      if (gameOver) return handleGameOver();

      let html = `<div class="food" style="grid-area:${foodY}/${foodX}"></div>`;

      if (snakeX === foodX && snakeY === foodY) {
        changeFoodPosition();
        score++;
        highScore = score > highScore ? score : highScore;
        localStorage.setItem("high-score", highScore);
        scoreEle.textContent = `Score: ${score}`;
        highScoreEle.textContent = `High Score: ${highScore}`;
        snakeBody.push([foodX, foodY]);
      }

      for (let i = snakeBody.length - 1; i > 0; i--) {
        snakeBody[i] = snakeBody[i - 1];
      }

      snakeBody[0] = [snakeX, snakeY];
      snakeX += velocityX;
      snakeY += velocityY;

      if (snakeX <= 0 || snakeX > 30 || snakeY <= 0 || snakeY > 30) {
        gameOver = true;
      }

      for (let i = 0; i < snakeBody.length; i++) {
        html += `<div class="snake" style="grid-area:${snakeBody[i][1]}/${snakeBody[i][0]}"></div>`;
        if (i !== 0 && snakeBody[0][1] === snakeBody[i][1] && snakeBody[0][0] === snakeBody[i][0]) {
          gameOver = true;
        }
      }

      playBoard.innerHTML = html;
    };

    changeFoodPosition();
    setIntervalId = setInterval(initGame, 120);
    document.addEventListener("keydown", (e) => {
      if (e.key === " ") togglePause();
      else changeDirection(e);
    });
  </script>
</body>
</html>
